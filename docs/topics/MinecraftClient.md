# Класс MinecraftClient

Класс `MinecraftClient` — это минималистичная обертка над TCP-соединением, предназначенная
для передачи пакетов Minecraft-протокола. Он не выполняет обработку пакетов, а лишь отправляет
и принимает их, предоставляя низкоуровневый доступ к сетевому взаимодействию.

Этот класс одноразовый: после отключения, ошибки или остановки соединения его нельзя
повторно использовать — необходимо создать новый экземпляр.

Исходный код: [MinecraftClient.cs](https://github.com/Titlehhhh/McProtoNet/blob/master/src/McProtoNet/Client/MinecraftClient.cs)

<warning>
Методы для записи и чтения пакетов у этого класса не являются потокобезопасными, то есть 
не стоит, например, одновременно вызывать метод <code>SendPacket</code> из разных потоков.
</warning>

### Основные методы

#### ConnectAsync(CancellationToken)
Устанавливает соединение с сервером Minecraft на основе переданных параметров.

#### SendPacket(IClientPacket, CancellationToken)
Отправляет указанный пакет серверу. Этот метод не является потокобезопасным.

#### IAsyncEnumerable<IPacket> ReceivePackets(CancellationToken)
Возвращает асинхронный поток пакетов, получаемых от сервера.
Важно - пакеты не хранятся в какой очереди, а лишь читаются из сети, когда вызывается
MoveNextAsync у [IAsyncEnumerator](https://learn.microsoft.com/ru-ru/dotnet/api/system.collections.generic.iasyncenumerator-1?view=net-9.0).

#### Dispose()
Закрывает соединение и освобождает ресурсы.

#### SwitchEncryption(Span<byte> key)
Включает шифрование соединения с использованием переданного ключа.

#### SwitchCompression(int threshold)
Включает сжатие пакетов, если их размер превышает указанный порог.

### Основные настройки

<deflist>
<def title="Host">
Хост (IP-адрес или доменное имя) сервера Minecraft для подключения.
</def>
<def title="Port">
Порт, используемый для подключения к серверу Minecraft. 
По умолчанию используется стандартный порт Minecraft — 25565.
</def>
<def title="Username">
Имя пользователя, которое будет использоваться для аутентификации на сервере.
</def>
<def title="Version">
Версия протокола Minecraft, с которой должен работать клиент. 
Этот параметр используется для обеспечения совместимости с различными версиями сервера.
</def>
<def title="Proxy?">
Прокси-сервер, через который будет осуществляться подключение. 
Если не указан, подключение происходит напрямую.
</def>
<def title="ConnectTimeout">
Таймаут подключения к серверу. 
Устанавливает максимальное время ожидания установления соединения.
</def>
<def title="ReadTimeout">
Таймаут чтения данных из сети, измеряется в миллисекундах. 
Этот параметр определяет, сколько времени клиент будет ожидать данные от сервера.
</def>
<def title="WriteTimeout">
Таймаут записи данных в сеть, измеряется в миллисекундах. 
Этот параметр определяет, сколько времени клиент будет ожидать успешную отправку данных на сервер.
</def>
</deflist>

